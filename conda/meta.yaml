{% set name = "Karabo-Pipeline" %}

package:
  name: {{ name|lower }}
  version: {{ KARABO_VERSION }}

source:
  path: ../

build:
  number: {{ BUILD_NUMBER }}
  string: py{{ CONDA_PY }}h{{ PKG_HASH }}_{{ BUILD_NUMBER }}

requirements:
  build:
    - python                  {{ python }}
    - pip
  host:
    - python                  {{ python }}
    - pip
  run:
    - python                  {{ python }}
    - aratmospy               =1.0.0
    - astropy
    - bdsf                    =1.10.2
    - bluebild
    - cuda-cudart
    - dask                    >=2022.12.1
    - dask-mpi
    - distributed
    - eidos                   =1.1.0
    - healpy
    - h5py                    =*=mpi_mpich*  # hdf5 mpich-whl python bindings
    - ipython
    - katbeam                 =0.1.0
    - libcufft
    - matplotlib
    - montagepy               =6.0.0
    - mpi4py  # python bindings for mpi, it's implementation (mpich or openmpi) depends on other wheels
    - mpich  # explicit mpich as dep for `mpi4py`. mpich & openmpi support linux & mac (not windows)
    - nbformat
    - nbconvert
    - numpy                   >=1.21, !=1.24.0  # 1.24.0 is a buggy release
    - oskarpy                 =2.8.3
    - pandas
    - psutil
    - rascil                  =1.0.0
    - reproject
    - requests
    - scipy                   >=1.10.1
    - ska-gridder-nifty-cuda  =0.3.0
    - ska-sdp-datamodels      =0.1.3
    - ska-sdp-func-python     =0.1.4
    - tools21cm               =2.0.2
    - xarray                  >=2022.10.0
    # transversal dependencies which we need to reference to get mpi-wheels
    - conda-forge::fftw       =*=mpi_mpich*  # oskarpy(oskar(casacore)), tools21cm, bluebild(finufft) -> from conda-forge to ignore channel prio i4ds > conda-forge
    # - casacore                =*=mpi_openmpi*  # oskarpy(oskar) -> casacore has just nompi & openmpi-wheels



test:
  imports:
    - karabo

about:
  home: https://github.com/i4Ds/Karabo-Pipeline
  license: MIT
  license_family: MIT
  license_file: LICENSE
  summary: 'Astronomy data centric pipeline built for SKA (Square Kilometer Array) and beyond.'
  description: |
   Astronomy data centric pipeline built for SKA (Square Kilometer Array) and beyond.
  doc_url: https://github.com/i4Ds/Karabo-Pipeline/wiki
  dev_url: https://github.com/i4Ds/Karabo-Pipeline

extra:
  recipe-maintainers:
    - lukas.gehrig@fhnw.ch
